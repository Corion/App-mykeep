<style>
span[contentEditable] {
        cursor: pointer;
        background-color: #D0D0D0;
    }

[contentEditable].empty:before {
  color: gray;
  content: "Title";
}

[contentEditable].empty:focus:before {
  height: 1em;
  content: "|"; /* Erase that placeholder text again */
}

#topbar {
    display: block;
    margin: 0px;
    padding: 0px;
    background-color: #fb0;
}

.mybrick {
  border: 1px solid black;
  width: 240px;
  min-height: 3em;
  float: left;
  margin: 16px;
  padding: 8px;

  /* Shadows */
  /* Firefox */
  -moz-box-shadow:5px 5px 7px rgba(33,33,33,1);
  /* Safari+Chrome */
  -webkit-box-shadow: 5px 5px 7px rgba(33,33,33,.7);
  /* Opera */
  box-shadow: 5px 5px 7px rgba(33,33,33,.7);
  
  background-color: rgba(255,220,30,1);
  
  margin-bottom: 16px;
}

button {
    border: none;
    background-color: transparent;
    display: inline;
}

h2 {
  display:block;
}
</style>

<!-- these should be automagically inserted resp. converted from static
     Javascript which is compiled from the templates -->
<!-- later -->
<script id="tmplItem" type="text/x-handlebars-template">
      <div class="note mybrick masonry-brick" id="note-\{\{id}}" style="background-color: \{\{bgcolor}}">
          <input type="hidden" name="id" value="\{\{id}}" />
          <h2 class="\{\{#unless title}}empty\{\{/unless}}" contenteditable="true" onblur="updateModel(this)">\{\{title}}</h2>
          <div class="note-text" contenteditable="true" onblur="updateModel(this)">\{\{\{text}}}</div>
          <div class="note-toolbar">
              <!-- These URLs should be made no-Javascript-friendly -->
              <a href="#" onclick="archiveItemUI(this)">x</a>
              <a href="#" onclick="UIdeleteItem(this)">d</a>
              <a href="#" onclick="syncItemUI(this)">u</a>
              <span id="sync-\{\{id}}">sync</span>
              <span id="modified-\{\{id}}">\{\{modifiedAt}}</span>
          </div>
      </div>
</script>

<script id="tmplItems" type="text/x-handlebars-template">
    \{\{#each notes}}
        \{\{> tmplItem note=this }}
    \{\{else}}
        <p>Nothing to see here</p>
    \{\{/each}}
</script>

<script>
// Compile all our templates, until we can do that statically
$('script[type="text/x-handlebars-template"').each(function(i, item) {
    //console.log([$(item).attr('id'), $(item).html()]);
    // We should unescape the template here, later
    var html = $(item).html();
    html = html.replace(/\\{/g, "{"); // Goddamn Text::Handlebars
    
    Handlebars.registerPartial($(item).attr('id'), html );
});

var html = $("#tmplItems").html();
html = html.replace(/\\{\\{/g, "{"+"{"); // Goddamn Text::Handlebars
var tmplItems = Handlebars.compile(html);
</script>

<div>
  <!-- app-bar -->
  <div id="topbar"><div style="display:inline">Ideas</div>
      <form action="." method="POST" onsubmit="javascript:UIfilterItem(); return false;">
        <input name="search" type="text" size="30" placeholder="search" onchange="javascript:UIfilterItem(); return false;" />
        <button class="search" aria-label="Search" role="button" tabindex="0">
        <svg height="24px" viewBox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg>
        </button>
      </form>
      <button arial-role="Refresh" onclick="UIlistItems()" user-select="none">Refresh
      </button>
  </div>
  <div>
    <div id="new-note-toolbar" style="display: block;">
      <form action="." method="POST" onsubmit="javascript:UIaddItem(); return false;">
        <input type="text" name="newNoteBody" id="newNoteBody"  size="30" placeholder="add new note here">
        <input class="btn-primary" type="submit" value="add">
      </form>
    </div>
    <div id="items">
    </div>
  </div>
</div>